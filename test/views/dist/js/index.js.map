{"version":3,"file":null,"sources":["../../src/js/src/utils/common.js","../../src/js/src/utils/event.js","../../src/js/src/utils/xajax.js","../../src/js/src/state.js","../../src/js/src/inject.js","../../src/js/src/urltest.js","../../src/js/src/log.js","../../src/js/src/modal.js","../../src/js/src/index.js"],"sourcesContent":["\r\nexport const jsonToQuery = function (a) {\r\n    const add = function (s, k, v) {\r\n        v = typeof v === 'function' ? v() : v === null ? '' : v === undefined ? '' : v;\r\n        s[s.length] = encodeURIComponent(k) + '=' + encodeURIComponent(v);\r\n    };\r\n    const buildParams = function (prefix, obj, s) {\r\n        let i;\r\n        let len;\r\n        let key;\r\n\r\n        if (Object.prototype.toString.call(obj) === '[object Array]') {\r\n            for (i = 0, len = obj.length; i < len; i++) {\r\n                buildParams(prefix + '[' + (typeof obj[i] === 'object' ? i : '') + ']', obj[i], s);\r\n            }\r\n        } else if (obj && obj.toString() === '[object Object]') {\r\n            for (key in obj) {\r\n                if (obj.hasOwnProperty(key)) {\r\n                    if (prefix) {\r\n                        buildParams(prefix + '[' + key + ']', obj[key], s, add);\r\n                    } else {\r\n                        buildParams(key, obj[key], s, add);\r\n                    }\r\n                }\r\n            }\r\n        } else if (prefix) {\r\n            add(s, prefix, obj);\r\n        } else {\r\n            for (key in obj) {\r\n                add(s, key, obj[key]);\r\n            }\r\n        }\r\n        return s;\r\n    };\r\n    return buildParams('', a, []).join('&').replace(/%20/g, '+');\r\n};\r\n\r\nexport const JSONParse = function () {\r\n    if (window.JSON) {\r\n        return JSON.parse;\r\n    } else {\r\n        return function (jsonstr) {\r\n            return (new Function(\"return\" + jsonstr))();\r\n        };\r\n    }\r\n}();","export const isMobile = function() {\r\n    try {\r\n        document.createEvent(\"TouchEvent\");\r\n        return true;\r\n    } catch (e) {\r\n        return false;\r\n    }\r\n}();\r\n\r\nexport const bindEvent = (element, event, cb, capture) => {\r\n    !element.addEventListener && (event = 'on' + event);\r\n    (element.addEventListener || element.attachEvent).call(element, event, cb, capture);\r\n    return cb;\r\n};\r\n\r\nexport const bindClickEvent = (element, cb, stop, capture) => {\r\n    let eventType = isMobile ? 'touchstart' : 'click';\r\n    if (stop) {\r\n        return bindEvent(element, eventType, function(event) {\r\n            cb.apply(this, arguments);\r\n            if (event.preventDefault) {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n            } else {\r\n                event.returnValue = false;\r\n            }\r\n        }, capture);\r\n    } else {\r\n        return bindEvent(element, eventType, cb, capture);\r\n    }\r\n};\r\n","import {\r\n    jsonToQuery,\r\n    JSONParse\r\n} from './common.js';\r\n\r\nconst win = typeof window !== 'undefined' ? window : self;\r\n// Get XMLHttpRequest object\r\nlet xdr;\r\nlet getXHR = win.XMLHttpRequest ? function() {\r\n    return new win.XMLHttpRequest();\r\n} : function() {\r\n    return new win.ActiveXObject('Microsoft.XMLHTTP');\r\n};\r\nlet mimeTypes = {\r\n    text: '*/*',\r\n    xml: 'text/xml',\r\n    json: 'application/json',\r\n    post: 'application/x-www-form-urlencoded',\r\n    document: 'text/html'\r\n};\r\n\r\nlet xhr2 = (getXHR().responseType === '');\r\n\r\nfunction XAjax(url, data, options) {\r\n    let headers = {\r\n        Accept: '*/*',\r\n        'Cache-Control': ''\r\n    };\r\n    if (options.headers && (Object.prototype.toString.call(options.headers).includes('Object'))) {\r\n        Object.assign(headers, options.headers);\r\n    }\r\n    this.callback = options.callback;\r\n    let method = (options.method && options.method.toLowerCase()) || 'get';\r\n    this.url = url;\r\n    if (data) {\r\n        if (method === 'get') {\r\n            this.url = url + '?' + jsonToQuery(data);\r\n        } else {\r\n            // Prepare data\r\n            // default datatype\r\n            let dataType = options.dataType || 'post';\r\n            if ('ArrayBuffer' in win && data instanceof ArrayBuffer) {\r\n                dataType = 'arraybuffer';\r\n            } else if ('Blob' in win && data instanceof Blob) {\r\n                dataType = 'blob';\r\n            } else if ('Document' in win && data instanceof Document) {\r\n                dataType = 'document';\r\n            } else if ('FormData' in win && data instanceof FormData) {\r\n                dataType = 'formdata';\r\n            }\r\n            if (!('Content-Type' in headers)) {\r\n                if (dataType in mimeTypes) {\r\n                    if (mimeTypes[dataType]) {\r\n                        headers['Content-Type'] = mimeTypes[dataType];\r\n                    }\r\n                }\r\n            }\r\n            switch (dataType) {\r\n                case 'json':\r\n                    data = JSON.stringify(data);\r\n                    break;\r\n                case 'post':\r\n                    data = jsonToQuery(data);\r\n            }\r\n            this.data = data;\r\n        }\r\n    } else {\r\n        this.data = {};\r\n    }\r\n\r\n\r\n    this.errHandler = options.errHandler || function(msg) {\r\n        console.log(`error: ${msg}`);\r\n    };\r\n    // Prepare URL\r\n\r\n    this.options = {\r\n        _async: true,\r\n        timeout: 30000,\r\n        attempts: 2\r\n    };\r\n    this.attempts = 0;\r\n    this.aborted = false;\r\n    // timeout id\r\n    this.timeoutid = null;\r\n    // Guess if we're dealing with a cross-origin request\r\n    let i = url.match(/\\/\\/(.+?)\\//);\r\n    this.crossOrigin = i && (i[1] ? i[1] !== location.host : false);\r\n    if (!this.crossOrigin && !('X-Requested-With' in headers)) { // (that header breaks in legacy browsers with CORS)\r\n        headers['X-Requested-With'] = 'XMLHttpRequest';\r\n    }\r\n    this.headers = headers;\r\n    this.method = method;\r\n}\r\n\r\nXAjax.prototype.abort = function() {\r\n    if (!this.aborted) {\r\n        if (this.xhr && this.xhr.readyState !== 4) { // https://stackoverflow.com/questions/7287706/ie-9-javascript-error-c00c023f\r\n            this.xhr.abort();\r\n        }\r\n        this.aborted = true;\r\n    }\r\n};\r\n\r\nXAjax.prototype.handleResponse = function(xhr = this.xhr) {\r\n    clearTimeout(this.timeoutid);\r\n    // Verify if the request has not been previously aborted\r\n    if (this.aborted) {\r\n        return;\r\n    }\r\n    // Handle response\r\n    try {\r\n        // Process response\r\n        if (xhr.responseType === 'json') {\r\n            if ('response' in xhr && xhr.response === null) {\r\n                throw 'The request response is empty';\r\n            }\r\n            this.response = xhr.response;\r\n        } else {\r\n            this.response = JSONParse(xhr.responseText);\r\n        }\r\n        // Late status code verification to allow passing data when, per example, a 409 is returned\r\n        // --- https://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\r\n        if ('status' in xhr && !/^2|1223/.test(xhr.status)) {\r\n            throw xhr.status + ' (' + xhr.statusText + ')';\r\n        }\r\n        // Fulfilled\r\n        this.callback(this.response);\r\n    } catch (e) {\r\n        // Rejected\r\n        this.handleError(e);\r\n    }\r\n};\r\n\r\nXAjax.prototype.handleTimeout = function() {\r\n    if (!this.aborted) {\r\n        if (!this.options.attempts || ++this.attempts !== this.options.attempts) {\r\n            this.xhr.abort();\r\n            this.send();\r\n        } else {\r\n            this.handleError({\r\n                message: 'Timeout (' + this.url + ')'\r\n            });\r\n        }\r\n    }\r\n};\r\n\r\nXAjax.prototype.handleError = function(e) {\r\n    console.log(e);\r\n    let message = e && e.message;\r\n    if (!this.aborted) {\r\n        message = typeof message === 'string' ? message : 'Connection aborted';\r\n        this.abort();\r\n        this.errHandler(message);\r\n    }\r\n};\r\n\r\nXAjax.prototype.send = function({\r\n    method = this.method,\r\n    url = this.url,\r\n    options = this.options,\r\n    headers = this.headers\r\n} = {}) {\r\n    // Get XHR object\r\n    let xhr = getXHR();\r\n    if (this.crossOrigin && win.XDomainRequest) {\r\n        xhr = new XDomainRequest(); // CORS with IE8/9\r\n        xdr = true;\r\n    }\r\n    // Open connection\r\n    if (xdr) {\r\n        xhr.open(method, url);\r\n    } else {\r\n        xhr.open(method, url, options._async);\r\n    }\r\n    this.xhr = xhr;\r\n\r\n\r\n\r\n    // Set headers\r\n    if (!xdr) {\r\n        for (var i in headers) {\r\n            if (headers[i]) {\r\n                xhr.setRequestHeader(i, headers[i]);\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    // Plug response handler\r\n    if (xhr2 || xdr) {\r\n        xhr.onload = () => {\r\n            this.handleResponse.apply(this);\r\n        };\r\n        xhr.onerror = () => {\r\n            this.handleError.apply(this);\r\n        };\r\n        // http://cypressnorth.com/programming/internet-explorer-aborting-ajax-requests-fixed/\r\n        if (xdr) {\r\n            xhr.onprogress = function() {};\r\n        }\r\n    } else {\r\n        xhr.onreadystatechange = () => {\r\n            if (xhr.readyState === 4) {\r\n                this.handleResponse.apply(this);\r\n            }\r\n        };\r\n    }\r\n    // Plug timeout\r\n    if (options._async) {\r\n        if ('timeout' in xhr) {\r\n            xhr.timeout = options.timeout;\r\n            xhr.ontimeout = () => {\r\n                this.handleTimeout.apply(this);\r\n            };\r\n        } else {\r\n            this.timeoutid = setTimeout(() => {\r\n                this.handleTimeout.apply(this);\r\n            }, options.timeout);\r\n        }\r\n        // http://cypressnorth.com/programming/internet-explorer-aborting-ajax-requests-fixed/\r\n    } else if (xdr) {\r\n        xhr.ontimeout = function() {};\r\n    }\r\n\r\n    // Send request\r\n    if (xdr) {\r\n        // https://developer.mozilla.org/en-US/docs/Web/API/XDomainRequest\r\n        setTimeout(function() {\r\n            xhr.send(this.method !== 'get' ? this.data : null);\r\n        }, 0);\r\n    } else {\r\n        xhr.send(this.method !== 'get' ? this.data : null);\r\n    }\r\n};\r\n\r\nexport default XAjax;","export const __proto__ = Object.create(null);\r\n__proto__.applyCallback = function applyCallback(key, func, type) {\r\n\r\n    const property = Object.getOwnPropertyDescriptor(this, key)\r\n    if (property && property.configurable === false) {\r\n        return;\r\n    }\r\n    \r\n    const getter = property && property.get;\r\n    let _value;\r\n\tgetter ? (_value = getter.call(this)) : (_value = (property && property.value));\r\n\r\n    const setter = property && property.set\r\n    const newProperty = {\r\n        enumerable: true,\r\n        configurable: true,\r\n    };\r\n    if (type === 'get') {\r\n        getter ? (newProperty.get = () => {\r\n            let oldval = getter.call(this);\r\n            let val = func.call(this, _value, oldval)\r\n            if (val != null) {\r\n            \treturn val;\r\n            } else {\r\n            \treturn _value;\r\n            }\r\n        }) : (newProperty.get = () => {\r\n        \tlet val = func.call(this)\r\n            if (val != null) {\r\n            \treturn val;\r\n            } else {\r\n            \treturn _value;\r\n            }\r\n        });\r\n        if (!setter) {\r\n        \tnewProperty.set = (val) => {\r\n        \t\t_value = val;\r\n        \t}\r\n        }\r\n    } else if (type === 'set') {\r\n        setter ? (newProperty.set = (val) => {\r\n            setter.call(this, val);\r\n            func.call(this, val);\r\n        }) : (newProperty.set = (val) => {\r\n            let oldval = _value;\r\n            _value = val;\r\n        \tfunc.call(this, val, oldval);\r\n        });\r\n        if (!getter) {\r\n        \tnewProperty.get = () => {\r\n        \t\treturn _value;\r\n        \t}\r\n        }\r\n    }\r\n    Object.defineProperty(this, key, newProperty);\r\n}\r\n\r\nexport const arrayproto = [];\r\nObject.assign(arrayproto, __proto__);\r\n\r\nexport const state = {\r\n    __proto__,\r\n    // 0 -> mock, 1-> forward\r\n    fetch: 1,\r\n    injected: false,\r\n    socketid: null,\r\n    mockList: {__proto__: arrayproto, length: 0, dirty: false},\r\n    urlList: {__proto__: arrayproto, length: 0},\r\n    logList: {__proto__: arrayproto, length: 0},\r\n    modal: {\r\n        __proto__,\r\n        show: false,\r\n        // 0 -> edit/add mock json ,1 -> view obj\r\n        type: 0,\r\n        title: '',\r\n        data: ''\r\n    }\r\n}\r\n","import {\r\n    bindEvent,\r\n    XAjax\r\n} from './utils';\r\nimport {\r\n    state\r\n} from './state.js';\r\n\r\n\r\nconst editMockBtn = document.getElementById('editDataBtn');\r\nconst addMockBtn = document.getElementById('addDataBtn');\r\nconst delMockBtn = document.getElementById('delDataBtn');\r\n\r\nconst injectBtn = document.getElementById('injectBtn');\r\nconst dataSelect = document.getElementById('dataSelect');\r\n\r\nlet datalist = document.querySelectorAll('#dataSelect option');\r\n\r\nstate.mockList.push(...Array.prototype.map.call(datalist, x => x.innerText));\r\nstate.mockList.current = 0;\r\n\r\nconst projectInput = document.getElementById('project');\r\nconst fetchInput = document.getElementById('fetchurl');\r\nconst mockFetch = document.getElementById('mockfetch');\r\nconst reportInput = document.getElementById('reporturl');\r\nconst mockReport = document.getElementById('mockreport');\r\n\r\n\r\nstate.applyCallback('fetch', function(isforward) {\r\n    if (isforward) {\r\n        dataSelect.setAttribute('disabled', true);\r\n        editMockBtn.setAttribute('disabled', true);\r\n        addMockBtn.setAttribute('disabled', true);\r\n        delMockBtn.setAttribute('disabled', true);\r\n    } else {\r\n        dataSelect.removeAttribute('disabled');\r\n        editMockBtn.removeAttribute('disabled');\r\n        addMockBtn.removeAttribute('disabled');\r\n        delMockBtn.removeAttribute('disabled');\r\n    }\r\n}, 'set');\r\nstate.fetch = 1;\r\n\r\nstate.mockList.applyCallback('length', function(val) {\r\n    this.dirty = true;\r\n}, 'set');\r\n\r\nstate.mockList.applyCallback('dirty', function(val) {\r\n    if(val) {\r\n        setTimeout(() => {\r\n            // render options\r\n            dataSelect.innerHTML = ''; \r\n            for(let v of this) {\r\n                if (v) {\r\n                    let node = document.createElement('option');\r\n                    node.value = v;\r\n                    node.innerText = v;\r\n                    dataSelect.appendChild(node);\r\n                }\r\n            }\r\n            this.dirty = false;\r\n            dataSelect.selectedIndex = state.mockList.current || 0;\r\n        }, 10);\r\n    }\r\n}, 'set');\r\n\r\nexport function exeInject(notify = true) {\r\n    let data = {\r\n        project: projectInput.value,\r\n        orginApi: JSON.stringify({\r\n            fetch: fetchInput.value,\r\n            report: reportInput.value\r\n        }),\r\n        mockApi: JSON.stringify({\r\n            fetch: mockFetch.value,\r\n            report: mockReport.value\r\n        }),\r\n        socketid: state.socketid\r\n    };\r\n    let getJson = new XAjax('/api/inject', data, {\r\n        method: 'post',\r\n        callback(result) {\r\n            if (result.code === 200) {\r\n                state.injected = true;\r\n                notify && alert('注入成功');\r\n            } else {\r\n                alert('注入失败，请查看控制台打印的结果');\r\n            }\r\n\r\n            console.log(result);\r\n        }\r\n    });\r\n    getJson.send();\r\n}\r\n\r\nfunction setMock(filename) {\r\n    let getJson = new XAjax('/api/task/setmock', {\r\n        filename\r\n    }, {\r\n        callback(result) {\r\n            if (result.code !== 200) {\r\n                alert('mock数据设置失败，请查看控制台打印的结果');\r\n                console.log(result);\r\n            }\r\n        }\r\n    });\r\n    getJson.send();\r\n}\r\n\r\nbindEvent(editMockBtn, 'click', (event) => {\r\n    state.modal.type = 0;\r\n    state.modal.title = dataSelect.value;\r\n    state.modal.show = true;\r\n});\r\n\r\nbindEvent(addMockBtn, 'click', (event) => {\r\n    state.modal.type = 0;\r\n    state.modal.show = true;\r\n    state.modal.title = '';\r\n    // state.mockList.current = state.mockList.length;\r\n    // state.mockList.push('');\r\n});\r\n\r\nbindEvent(injectBtn, 'click', (event) => {\r\n    exeInject();\r\n    if (dataSelect.getAttribute('disabled') == null) {\r\n        setMock(dataSelect.value);\r\n    }\r\n    if (event.preventDefault) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n    } else {\r\n        event.returnValue = false;\r\n    }\r\n});\r\n\r\n\r\nbindEvent(dataSelect, 'change', (event) => {\r\n    state.mockList.current = dataSelect.selectedIndex;\r\n});\r\n\r\nbindEvent(mockFetch, 'change', (event) => {\r\n    state.fetch = (mockFetch.value.includes('forward') ? 1 : 0);\r\n});\r\n","import { bindEvent, XAjax } from './utils';\r\nimport { state } from './state.js'\r\n\r\nconst urlList = document.getElementById(\"urllist\");\r\nlet urls = document.querySelectorAll('#urllist li');\r\nstate.urlList.push(...Array.prototype.map.call(urls, x => ({text: x.innerText.trim(), node:x})));\r\nconst urlInput = document.getElementById(\"customurl\");\r\nconst addBtn = document.getElementById(\"addBtn\");\r\nconst gotoBtn = document.getElementById(\"gotoBtn\");\r\n\r\nexport const host = gotoBtn.dataset.host;\r\n\r\nstate.urlList.applyCallback('length', function(val, oldval) {\r\n    if (val) {\r\n        this.dirty = true;\r\n    }\r\n}, 'set');\r\n// console.log(state.urlList);\r\nstate.urlList.applyCallback('dirty', function(val) {\r\n    if(val) {\r\n        // only add or remove\r\n        setTimeout(() => {\r\n            // render options\r\n            for(let v of this) {\r\n                if (!v.node) {\r\n                    let node = document.createElement('li');\r\n                    node.innerHTML = `<img src=\"/static/img/copy.svg\"><a href=\"javascript:void(0);\">${v.text}</a>`;\r\n                    urlList.appendChild(node);\r\n                    v.node = node;\r\n                }\r\n                if (!v.converted) {\r\n                    bindEvent(v.node, 'click', (e) => {\r\n                        let url = buildUrl(v.text);\r\n                        let tagname;\r\n                        if((tagname = e.target.tagName.toLowerCase()) === 'a') {\r\n                            state.logList.push({text: `You have click the link to : ${url}`});\r\n                            window.open(url);\r\n                        } else if (tagname === 'img') {\r\n                            window.prompt(\"Copy to clipboard: Ctrl+C, Enter\", url);\r\n                        }\r\n\r\n                    });\r\n                    v.converted = true;\r\n                }\r\n            }\r\n            this.dirty = false;\r\n        }, 10);\r\n    }\r\n}, 'set');\r\n\r\nstate.urlList.dirty = true;\r\n\r\nbindEvent(urlList, 'click', (event) => {\r\n    if (!state.injected) {\r\n        alert('请先注入脚本');\r\n        if (event.preventDefault) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        } else {\r\n            event.returnValue = false;\r\n        }\r\n    }\r\n}, true);\r\n\r\nbindEvent(addBtn, 'click', (event) => {\r\n    let url = urlInput.value;\r\n    if (state.urlList.find(x => x.text === url)) {\r\n        alert('列表中已存在');\r\n    } else {\r\n        let getJson = new XAjax('/api/test/addurl', {url}, {\r\n            callback(result) {\r\n                if(result.code === 200) {\r\n                    state.urlList.push({text: url});\r\n                } else {\r\n                    alert('添加失败');\r\n                }\r\n            }\r\n        });\r\n        getJson.send();\r\n    }\r\n});\r\n\r\n\r\nbindEvent(gotoBtn, 'click', (event) => {\r\n\tif (state.injected) {\r\n\t\tlet url;\r\n\t    if (url = urlInput.value) {\r\n\t    \twindow.open(buildUrl(url));\r\n\t    }\r\n\t} else {\r\n        alert('请先注入脚本');\r\n        if (event.preventDefault) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n        } else {\r\n            event.returnValue = false;\r\n        }\r\n\t}\r\n});\r\n\r\nfunction buildUrl(url) {\r\n    let fwdurl = `http://${host}/api/page/html?pageUrl=${encodeURIComponent(url)}&id=${state.socketid}`;\r\n    return fwdurl;\r\n}\r\n","import {\r\n\tstate\r\n} from './state.js';\r\nimport {\r\n\tbindEvent\r\n} from './utils';\r\nimport { host } from './urltest.js';\r\nimport { exeInject } from './inject';\r\nconst logUl = document.querySelector('.logbox ul');\r\nconst clearBtn = document.querySelector('.logbox .clear');\r\nstate.logList.applyCallback('length', function(val, oldval) {\r\n\tif (val) {\r\n\t\tclearBtn.style.display = \"inline-block\"\r\n\t\tthis.dirty = true;\r\n\t} else {\r\n\t\tfor (let i = 0; i < oldval; i++) {\r\n\t\t\tdelete this[i];\r\n\t\t}\r\n\t\tlogUl.innerHTML = '';\r\n\t\tclearBtn.style.display = 'none';\r\n\t}\r\n}, 'set');\r\nstate.logList.applyCallback('dirty', function(val) {\r\n\tif (val) {\r\n\t\t// only add or remove\r\n\t\tsetTimeout(() => {\r\n\t\t\t// render options\r\n\t\t\tfor (let v of this) {\r\n\t\t\t\tif (!v.node) {\r\n\t\t\t\t\tlet node = document.createElement('li');\r\n\t\t\t\t\tnode.value = v.text;\r\n\t\t\t\t\tnode.innerText = v.text;\r\n\t\t\t\t\tif (v.data) {\r\n\t\t\t\t\t\tlet a = document.createElement('a');\r\n\t\t\t\t\t\ta.innerText = 'more';\r\n\t\t\t\t\t\tbindEvent(a, 'click', () => {\r\n\t\t\t\t\t\t\tstate.modal.type = 1;\r\n\t\t\t\t\t\t\tstate.modal.data = JSON.stringify(v.data, null, 4);\r\n\t\t\t\t\t\t\tstate.modal.show = true;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\tnode.appendChild(a);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlogUl.appendChild(node);\r\n\t\t\t\t\tv.node = node;\r\n\t\t\t\t} else {\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis.dirty = false;\r\n\t\t}, 10);\r\n\t}\r\n}, 'set');\r\nbindEvent(clearBtn, 'click', function() {\r\n\tstate.logList.length = 0;\r\n})\r\nconst socket = io(`http://${host}`);\r\nsocket.on('connect', function() {\r\n\tstate.socketid = this.io.engine.id;\r\n\tstate.logList.push({ text: `ready to log from : http://${host} , your socket client id: ${state.socketid}` });\r\n\t// 页面加载后即注入\r\n\texeInject(false);\r\n});\r\nsocket.on('log', function(data) {\r\n\tlet { UBA, UBAid, spend } = data;\r\n\tlet text;\r\n\tif ((UBA != null) && (UBAid != null)) {\r\n\t\ttext = `log received: UBA:${UBA} , UBAid:${UBAid} , spend: ${spend}ms`;\r\n\t} else {\r\n\t\ttext = spend ? `log received, but no UBA and UBA id found, spend: ${spend}ms` : `log received, but no UBA and UBA id found`;\r\n\t}\r\n\tstate.logList.push({ text, data });\r\n});\r\nsocket.on('page', function(data) {\r\n\tlet { url, mobile } = data;\r\n\tlet text = `page test, url:${url}, platform:${mobile ? 'H5' : 'PC'}`;\r\n\tstate.logList.push({ text, data });\r\n});\r\nsocket.on('script', function(url) {\r\n\tlet text = `script has been injected to page, url:${url}`;\r\n\tstate.logList.push({ text });\r\n});\r\nsocket.on('api', function(data) {\r\n\tlet { span, json, url } = data;\r\n\tjson = JSON.parse(json || '') || {};\r\n\tlet text = `page received sdk data: total: ${json && (json = json.data) && json.total}, spend: ${span}ms , url: ${url}`;\r\n\tstate.logList.push({ text, data: json });\r\n\tconsole.log(json);\r\n});\r\n","import {\r\n    bindEvent,\r\n    XAjax\r\n} from './utils';\r\nimport {\r\n    state,\r\n    __proto__\r\n} from './state.js'\r\n\r\nconst modalBox = document.querySelector('.modal#dataModal');\r\nconst textarea = document.querySelector('.modal#dataModal textarea#jsonData');\r\nconst modalTitle = document.querySelector('.modal#dataModal .modal-title');\r\nconst nameInput = document.querySelector('.modal#dataModal .form-filename input');\r\nconst nameLengthSpan = document.querySelector('.modal#dataModal .form-filename span');\r\nconst nameEditBtn = document.querySelector('.modal#dataModal .form-filename .btn');\r\n\r\nconst modalFooter = document.querySelector('.modal#dataModal .modal-footer');\r\n\r\nconst applyBtn = document.querySelector('.modal#dataModal #apply');\r\nconst cancelBtn = document.querySelector('.modal#dataModal #cancel');\r\nconst closeBtn = document.querySelector('.modal#dataModal .close');\r\n\r\nstate.modal.applyCallback('show', function(val) {\r\n    if (val) {\r\n        modalBox.classList.remove(\"fade\");\r\n        modalBox.style.display = \"block\";\r\n        if(this.type === 0 && this.title) {\r\n            modalTitle.style.display = \"inline-block\";\r\n            nameEditBtn.style.display = \"inline-block\";\r\n            modalFooter.style.display = \"block\";\r\n            if (this.title) {\r\n                fetchJsonData(state.modal.title);\r\n            }\r\n        } else if (this.type === 1) {\r\n            modalTitle.style.display = \"none\";\r\n            nameEditBtn.style.display = \"none\";\r\n            modalFooter.style.display = \"none\";\r\n        }\r\n    } else {\r\n        modalBox.classList.add(\"fade\");\r\n        modalBox.style.display = \"none\";\r\n    }\r\n}, 'set');\r\n\r\nstate.modal.applyCallback('title', function(val) {\r\n    modalTitle.innerText = `修改数据 - ${val}`;\r\n    if(val === '') {;\r\n        filenameState.editting = true;\r\n    }\r\n}, 'set');\r\n\r\nstate.modal.applyCallback('data', function(val) {\r\n    textarea.value = val;\r\n}, 'set');\r\n\r\n\r\nexport const filenameState = {\r\n    __proto__,\r\n    editting: false,\r\n    length: 0\r\n}\r\n\r\nfilenameState.applyCallback('length', function(val) {\r\n    nameLengthSpan.innerText = `${val}/20`;\r\n}, 'set');\r\n\r\nfilenameState.applyCallback('editting', function(val) {\r\n    if (val) {\r\n        nameInput.style.display = \"inline-block\";\r\n        nameLengthSpan.style.display = \"inline-block\";\r\n        nameInput.value = state.modal.title;\r\n        filenameState.length = state.modal.title.length;\r\n        // 防止与alert冲突\r\n        setTimeout(() => {nameInput.focus()}, 100);\r\n    } else {\r\n        nameInput.style.display = \"none\";\r\n        nameLengthSpan.style.display = \"none\";\r\n    }\r\n}, 'set');\r\n\r\n\r\n\r\nfunction fetchJsonData(filename) {\r\n    let getJson = new XAjax('/api/task/mock', {\r\n        filename,\r\n        tag: 1\r\n    }, {\r\n        callback(result) {\r\n            state.modal.data = JSON.stringify(result, null, 4);\r\n        }\r\n    });\r\n    getJson.send();\r\n}\r\n\r\nfunction saveJsonData({callback, close} = {callback: null, close: true}) {\r\n    let filename = state.modal.title;\r\n\r\n    if (filename === '') {\r\n        alert('文件名不能为空');\r\n        state.modal.title = '';\r\n        return;\r\n    }\r\n    let getJson = new XAjax('/api/task/savemock', {\r\n        filename,\r\n        mockdata: textarea.value\r\n    }, {\r\n        method: 'post',\r\n        callback(result) {\r\n            if (result.code === 200) {\r\n                \r\n                if(close) {\r\n                    state.modal.show = false;\r\n                }\r\n                if (callback) {\r\n                    callback();\r\n                } else {\r\n                    alert('保存成功');\r\n                }\r\n                // location.reload(true);\r\n            } else {\r\n                alert('保存失败');\r\n                console.log(result);\r\n            }\r\n        }\r\n    });\r\n    getJson.send();\r\n}\r\n\r\nbindEvent(nameInput, 'blur', (event) => {\r\n    let newname = nameInput.value;\r\n    if (newname === '') {\r\n        alert('必须有文件名');\r\n        return false;\r\n    }\r\n    let oldname;\r\n\r\n    if (newname !== (oldname = state.modal.title)) {\r\n        if (oldname) {\r\n            // rename\r\n            let option = {\r\n                callback: (result) => {\r\n                    if (result.code === 200) {\r\n                        state.modal.title = newname;\r\n                        state.mockList[state.mockList.current] = newname;\r\n                        state.mockList.dirty = true;\r\n                        filenameState.editting = false;\r\n                    } else {\r\n                        alert('保存失败');\r\n                        console.log(result);\r\n                    }\r\n                },\r\n                method: 'post'\r\n            };\r\n            let postName = new XAjax('/api/task/renamemock', {\r\n                oldname,\r\n                newname\r\n            }, option);\r\n            postName.send();\r\n        } else {\r\n            // 新建文件\r\n            if (state.mockList.includes(newname)) {\r\n                alert('已存在相同文件名');\r\n            } else {\r\n                state.modal.title = newname;\r\n                saveJsonData({close: false, callback:() => {\r\n                    state.mockList.push(newname);\r\n                    state.mockList.current = state.mockList.length - 1;\r\n                    filenameState.editting = false;\r\n                }});\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nbindEvent(nameInput, 'input', (event) => {\r\n    filenameState.length = nameInput.value.length;\r\n});\r\n\r\nbindEvent(nameEditBtn, 'click', (event) => {\r\n    filenameState.editting = true;\r\n});\r\n\r\nbindEvent(applyBtn, 'click', (event) => {\r\n    saveJsonData();\r\n});\r\n\r\nbindEvent(cancelBtn, 'click', (event) => {\r\n    state.modal.show = false;\r\n});\r\n\r\nbindEvent(closeBtn, 'click', (event) => {\r\n    state.modal.show = false;\r\n});\r\n","// import './polyfills';\r\nimport './inject.js';\r\nimport './urltest.js';\r\nimport './log.js';\r\nimport './modal.js';"],"names":["jsonToQuery","a","add","s","k","v","undefined","length","encodeURIComponent","buildParams","prefix","obj","i","len","key","Object","prototype","toString","call","babelHelpers.typeof","hasOwnProperty","join","replace","JSONParse","window","JSON","parse","jsonstr","Function","isMobile","createEvent","e","bindEvent","element","event","cb","capture","addEventListener","attachEvent","win","self","xdr","getXHR","XMLHttpRequest","ActiveXObject","mimeTypes","xhr2","responseType","XAjax","url","data","options","headers","includes","assign","callback","method","toLowerCase","dataType","ArrayBuffer","Blob","Document","FormData","stringify","errHandler","msg","log","attempts","aborted","timeoutid","match","crossOrigin","location","host","abort","xhr","readyState","handleResponse","response","responseText","test","status","statusText","handleError","handleTimeout","send","message","XDomainRequest","open","_async","setRequestHeader","onload","apply","onerror","onprogress","onreadystatechange","timeout","ontimeout","setTimeout","__proto__","create","applyCallback","func","type","property","getOwnPropertyDescriptor","configurable","getter","get","_value","value","setter","set","newProperty","oldval","val","defineProperty","arrayproto","state","dirty","editMockBtn","document","getElementById","addMockBtn","delMockBtn","injectBtn","dataSelect","datalist","querySelectorAll","mockList","push","Array","map","x","innerText","current","projectInput","fetchInput","mockFetch","reportInput","mockReport","isforward","setAttribute","removeAttribute","fetch","innerHTML","node","createElement","appendChild","selectedIndex","exeInject","notify","socketid","getJson","result","code","injected","alert","setMock","filename","modal","title","show","getAttribute","preventDefault","stopPropagation","returnValue","urlList","urls","text","trim","urlInput","addBtn","gotoBtn","dataset","converted","buildUrl","tagname","target","tagName","logList","prompt","find","fwdurl","logUl","querySelector","clearBtn","style","display","socket","io","on","engine","id","UBA","UBAid","spend","mobile","span","json","total","modalBox","textarea","modalTitle","nameInput","nameLengthSpan","nameEditBtn","modalFooter","applyBtn","cancelBtn","closeBtn","classList","remove","editting","filenameState","focus","fetchJsonData","saveJsonData","close","newname","oldname","option","postName"],"mappings":"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"}