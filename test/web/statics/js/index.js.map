{"version":3,"file":"index.js","sources":["../../src/js/log.js","../../src/js/urltest.js","../../src/js/index.js"],"sourcesContent":["\r\nconst logUl = document.querySelector('.logbox ul');\r\nconst clearBtn = document.querySelector('.logbox .clear');\r\nexport function addLog(v) {\r\n\tlet node = document.createElement('li');\r\n\tnode.value = v.text;\r\n\tnode.innerText = v.text;\r\n\tlet atag;\r\n\tif (v.data) {\r\n\t\tlet a = document.createElement('a');\r\n\t\ta.innerText = 'more';\r\n\t\tnode.appendChild(a);\r\n\t\tatag = a;\r\n\t}\r\n\tlogUl.appendChild(node);\r\n\treturn atag;\r\n}","const urlList = document.getElementById(\"urllist\");\r\nconst urlInput = document.getElementById(\"customurl\");\r\nconst addBtn = document.getElementById(\"addBtn\");\r\nconst gotoBtn = document.getElementById(\"gotoBtn\");\r\n\r\nexport function setUrlList(list) {\r\n    urlList.innerHTML = '';\r\n    const stream = Rx.Observable.empty();\r\n    const streams = [];\r\n    for (let v of list) {\r\n        let click = inserUrl(v);\r\n        click && (streams.push(click));\r\n    }\r\n    var merged = stream.merge(...streams);\r\n    return merged;\r\n}\r\nexport function inserUrl(v) {\r\n    if (!v.node) {\r\n        let node = document.createElement('li');\r\n        node.innerHTML = `<img src=\"/statics/img/copy.svg\"><a href=\"javascript:void(0);\">${v.text}</a>`;\r\n        urlList.appendChild(node);\r\n        v.node = node;\r\n    }\r\n    if (!v.converted) {\r\n        return setUrlLink(v);\r\n        v.converted = true;\r\n    }\r\n}\r\nexport function setUrlLink(v) {\r\n    return Rx.Observable.fromEvent(v.node, 'click').map((e) => {\r\n        let url = buildUrl(v.text);\r\n        let tagname;\r\n        if ((tagname = e.target.tagName.toLowerCase()) === 'a') {\r\n            window.open(url);\r\n            return ({ text: `You have click the link to : ${url}` });\r\n        } else if (tagname === 'img') {\r\n            window.prompt(\"Copy to clipboard: Ctrl+C, Enter\", url);\r\n        }\r\n    })\r\n}\r\n\r\nfunction buildUrl(url) {\r\n    let fwdurl = `//${window.location.host}/html?url=${encodeURIComponent(url)}`;\r\n    return fwdurl;\r\n}\r\n\r\nexport function bindAddClick() {\r\n    return Rx.Observable.fromEvent(addBtn, 'click').map(e => urlInput.value);\r\n}\r\n\r\nexport function bindGotoClick() {\r\n    return Rx.Observable.fromEvent(gotoBtn, 'click').map(e => {\r\n        let url = urlInput.value;\r\n        window.open(buildUrl(url));\r\n        return url;\r\n    });\r\n}\r\n","import { addLog } from './log';\r\nimport { setUrlList, inserUrl, bindAddClick, bindGotoClick } from './urltest';\r\nconst socket = io(window.location.host);\r\nRx.Observable.fromEvent(socket, 'connect').map(x => ({ text: `ready to log from : ${window.location.host} , your socket client id: ${socket.io.engine.id}` })).map((data) => addLog(data)).filter(Boolean).subscribe(x => console.log(x));\r\nRx.Observable.fromEvent(socket, 'url').mergeMap(url => (inserUrl({ text: url }))).filter(Boolean).subscribe((data) => addLog(data));\r\nRx.Observable.fromEvent(socket, 'urls').map(x => x.map(url => ({ text: url }))).mergeMap(list => setUrlList(list)).filter(Boolean).subscribe((data) => addLog(data));\r\nbindAddClick().subscribe(x => socket.emit('addurl', x));\r\nbindGotoClick().subscribe((text) => addLog({text}));\r\n"],"names":["logUl","document","querySelector","clearBtn","addLog","v","node","createElement","value","text","innerText","atag","data","a","appendChild","urlList","getElementById","urlInput","addBtn","gotoBtn","setUrlList","list","innerHTML","stream","Rx","Observable","empty","streams","click","inserUrl","push","merged","merge","converted","setUrlLink","fromEvent","map","e","url","buildUrl","tagname","target","tagName","toLowerCase","open","prompt","fwdurl","window","location","host","encodeURIComponent","bindAddClick","bindGotoClick","socket","io","engine","id","filter","Boolean","subscribe","console","log","x","mergeMap","emit"],"mappings":"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"}